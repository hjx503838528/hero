var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(r,s){function a(t){try{h(n.next(t))}catch(e){s(e)}}function o(t){try{h(n["throw"](t))}catch(e){s(e)}}function h(t){t.done?r(t.value):new i(function(e){e(t.value)}).then(a,o)}h((n=n.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return n([t,e])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;h;)try{if(r=1,s&&(a=s[2&i[0]?"return":i[0]?"throw":"next"])&&!(a=a.call(s,i[1])).done)return a;switch(s=0,a&&(i=[0,a.value]),i[0]){case 0:case 1:a=i;break;case 4:return h.label++,{value:i[1],done:!1};case 5:h.label++,s=i[1],i=[0];continue;case 7:i=h.ops.pop(),h.trys.pop();continue;default:if(a=h.trys,!(a=a.length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){h=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){h.label=i[1];break}if(6===i[0]&&h.label<a[1]){h.label=a[1],a=i;break}if(a&&h.label<a[2]){h.label=a[2],h.ops.push(i);break}a[2]&&h.ops.pop(),h.trys.pop();continue}i=e.call(t,h)}catch(n){i=[6,n],s=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,s,a,o,h={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},BaseClass=function(){function t(){}return t.ins=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this;if(!i._instance){var n=t.length;0==n?i._instance=new i:1==n?i._instance=new i(t[0]):2==n?i._instance=new i(t[0],t[1]):3==n?i._instance=new i(t[0],t[1],t[2]):4==n?i._instance=new i(t[0],t[1],t[2],t[3]):5==n&&(i._instance=new i(t[0],t[1],t[2],t[3],t[4]))}return i._instance},t}();__reflect(BaseClass.prototype,"BaseClass");var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,n){function r(t){e.call(n,t)}function s(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),i.call(n))}var a=this;"undefined"!=typeof generateEUI?egret.callLater(function(){e.call(n,generateEUI)},this):"undefined"!=typeof generateEUI2?RES.getResByUrl("resource/gameEui.json",function(t,i){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(n,generateEUI2)},a)},this,RES.ResourceItem.TYPE_JSON):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),RES.getResByUrl(t,r,this,RES.ResourceItem.TYPE_TEXT))},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onaddToStage,e),e}return __extends(e,t),e.prototype.onaddToStage=function(){var t=this;this.con=new egret.DisplayObjectContainer,this.con.x=StageUtils.ins().getWidth()/2,this.con.y=StageUtils.ins().getHeight()/2,this.addChild(this.con);var e=new egret.ImageLoader;e.once(egret.Event.COMPLETE,function(e){var i=e.currentTarget,n=i.data,r=new egret.Texture;r._setBitmapData(n);var s=new egret.Bitmap(r);s.width=StageUtils.ins().getWidth(),s.height=StageUtils.ins().getHeight(),t.addChildAt(s,0)},this),e.load("resource/assets/images/bg3.jpg");for(var i,n=0,r=.1,s=0;10>s;s++)i=new egret.Shape,i.graphics.beginFill(16777215,r),i.graphics.drawCircle(0,0,10),i.graphics.endFill(),i.anchorOffsetX=-70,i.anchorOffsetY=i.height>>1,i.rotation=n,n+=36,r+=.1,this.con.addChild(i);this.textField=new egret.TextField,this.addChild(this.textField),this.textField.x=StageUtils.ins().getWidth()/2-50,this.textField.y=StageUtils.ins().getHeight()/2-15,this.textField.width=100,this.textField.textAlign="center",this.addEventListener(egret.Event.ENTER_FRAME,this.upLoadingData,this)},e.prototype.upLoadingData=function(){this.con.rotation+=36},e.prototype.onProgress=function(t,e){var i=Math.floor(t/e*100);this.textField.text=i+"%"},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var Main=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.left=this.right=this.top=this.bottom=0,egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,this.loadResource()];case 1:return e.sent(),this.createGameScene(),[4,platform.login()];case 2:return e.sent(),[4,platform.getUserInfo()];case 3:return t=e.sent(),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,4,,5]),t=new LoadingUI,this.stage.addChild(t),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return i.sent(),[4,this.loadTheme()];case 2:return i.sent(),[4,RES.loadGroup("preload",0,t)];case 3:return i.sent(),this.stage.removeChild(t),[3,5];case 4:return e=i.sent(),console.error(e),[3,5];case 5:return[2]}})})},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,i){var n=new eui.Theme("resource/default.thm.json",t.stage);n.addEventListener(eui.UIEvent.COMPLETE,function(){e()},t)})},e.prototype.createGameScene=function(){StageUtils.ins().getUIStage().addChild(new GameHoneWin)},e}(eui.UILayer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function n(n){e.call(i,n,t)}if(RES.hasRes(t)){var r=RES.getRes(t);r?n(r):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var GameData=function(t){function e(){var e=t.call(this)||this;return e.index=0,e.grade=0,e.bestGrade=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e}(BaseClass);__reflect(GameData.prototype,"GameData");var GameHoneWin=function(t){function e(){var e=t.call(this)||this;return e.skinName="GameHomeSkin",e.percentHeight=100,e.percentWidth=100,e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(){this.init(),this.startBtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onClick,this),this.startBtn.addEventListener(egret.TouchEvent.TOUCH_END,this.onClick,this),this.startBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.selectBtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onClick,this),this.selectBtn.addEventListener(egret.TouchEvent.TOUCH_END,this.onClick,this),this.selectBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},e.prototype.init=function(){var t=Math.floor(5*Math.random()+1);this.bgImg.source="bg"+t+"_jpg",this.moonImg.visible=2==t?!0:!1,egret.Tween.get(this.startBtn,{loop:!0}).to({y:570},1e3).to({y:550},1e3),this._mc=new Hero(GameData.ins().index),this.addChild(this._mc),this._mc.x=StageUtils.ins().getWidth()/2-this._mc.width/2,this._mc.y=StageUtils.ins().getHeight()-300+2},e.prototype.onClick=function(t){var e=t.target;switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:e.scaleX=e.scaleY=.9;break;case egret.TouchEvent.TOUCH_END:e.scaleX=e.scaleY=1;break;case egret.TouchEvent.TOUCH_TAP:e==this.startBtn?(StageUtils.ins().getUIStage().removeChild(this),StageUtils.ins().getUIStage().addChild(new GameWin)):e==this.selectBtn&&(GameData.ins().index=GameData.ins().index<4?GameData.ins().index+1:0,console.log("第"+GameData.ins().index+"人物"),this._mc.setIndex(GameData.ins().index),this._mc.x=StageUtils.ins().getWidth()/2-this._mc.width/2,this._mc.y=StageUtils.ins().getHeight()-300+2)}},e}(eui.Component);__reflect(GameHoneWin.prototype,"GameHoneWin");var GameWin=function(t){function e(){var e=t.call(this)||this;return e.stickH=0,e.lv=10,e.isDouble=!1,e.isCilck=!0,e.skinName="GameSkin",e.percentHeight=100,e.percentWidth=100,e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(){this.stageW=StageUtils.ins().getWidth(),this.stageH=StageUtils.ins().getHeight(),this.hero=new Hero(GameData.ins().index),this.addChild(this.hero),this.init(),this.home.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.restart.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.timer=new egret.Timer(1e3/60,0),this.timer.addEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),this.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComFunc,this),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onClickStage,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickStageEnd,this)},e.prototype.timerFunc=function(){var t=this.stageH-300;this.stickH<t&&(this.stickH+=10,this.stick.height=this.stickH)},e.prototype.timerComFunc=function(){},e.prototype.init=function(){var t=Math.floor(5*Math.random()+1);this.bgImg.source="bg"+t+"_jpg",this.moonImg.visible=2==t?!0:!1,this.isDouble=!1,this.touchEnabled=!0,this.overCon.visible=!1,this.red.visible=!0,this.leftRect.x=0,this.leftRect.width=150,this.rightRect.width=100+Math.floor(70*Math.random());var e=this.stageW-this.leftRect.width-this.rightRect.width-100,i=this.leftRect.width+Math.floor(e*Math.random())+100;this.rightRect.x=i,this.red.x=this.rightRect.x+this.rightRect.width/2-this.red.width/2,this.red.y=this.stageH-this.rightRect.height,GameData.ins().grade=0,this.stick.rotation=0,this.stickH=0,this.stick.height=0,this.stick.width=6,this.stick.x=this.leftRect.x+this.leftRect.width-1,this.hero&&(this.hero.x=this.leftRect.x+this.leftRect.width-this.hero.width-10,this.hero.y=this.stageH-this.rightRect.height+2)},e.prototype.onClick=function(t){switch(t.target){case this.home:StageUtils.ins().getUIStage().removeChild(this),StageUtils.ins().getUIStage().addChild(new GameHoneWin);break;case this.restart:this.init()}},e.prototype.onClickStage=function(t){t.target==this&&this.timer.start()},e.prototype.onClickStageEnd=function(t){var e=this;t.target==this&&(this.touchEnabled=!1,this.timer.stop(),this.stick.anchorOffsetX=this.stick.width,this.stick.anchorOffsetY=this.stick.height,egret.Tween.get(this.stick).to({rotation:90},300).call(function(){var t=e.stick.x+e.stick.height,i=e.red.x+e.red.width;t>=e.red.x&&i>=t&&(e.perfectTxt.visible=!0,e.perfectTxt.alpha=0,e.perfectTxt.x=e.red.x-50,e.perfectTxt.y=e.red.y,e.isDouble=!0,egret.Tween.get(e.perfectTxt).to({y:750,alpha:1},300).call(function(){e.perfectTxt.visible=!1},e));var n=e.stick.x+e.stick.height,r=e.rightRect.x+e.rightRect.width;if(n<e.rightRect.x||n>r)egret.Tween.get(e.hero).to({x:n},500).call(e.over,e);else{var s=e.rightRect.x+e.rightRect.width-e.hero.width-18;egret.Tween.get(e.hero).to({x:s},500).call(e.run,e)}e.hero._mc.gotoAndPlay("walk",-1),e.hero._mc.anchorOffsetY=e.hero._mc.height},this))},e.prototype.over=function(){var t=this;egret.Tween.get(this.hero).to({y:this.stageH+100},500).call(function(){var e=egret.Tween.get(t);e.to({x:20,y:20},100,egret.Ease.bounceOut),e.to({x:0,y:0},100,egret.Ease.bounceIn),e.to({x:20,y:20},100,egret.Ease.bounceOut),e.to({x:0,y:0},100,egret.Ease.bounceIn),e.to({x:20,y:20},100,egret.Ease.bounceOut),e.to({x:0,y:0},100,egret.Ease.bounceIn),e.call(t.showOverTip,t)},this)},e.prototype.run=function(){var t=this;this.hero._mc.gotoAndPlay("stay",-1),this.hero._mc.anchorOffsetY=this.hero._mc.height,this.isDouble?(this.isDouble=!1,GameData.ins().grade+=2):GameData.ins().grade++,this.gradeTxt.text=""+GameData.ins().grade,GameData.ins().bestGrade<GameData.ins().grade&&(GameData.ins().bestGrade=GameData.ins().grade,this.bestTxt.text=""+GameData.ins().bestGrade),this.stick.rotation=0,this.stickH=0,this.stick.height=0,this.stick.x=this.rightRect.width-1;var e=this.rightRect.width/2-this.red.width/2;egret.Tween.get(this.red).to({x:e},300),egret.Tween.get(this.rightRect).to({x:0},300),egret.Tween.get(this.hero).to({x:this.rightRect.width-this.hero.width-16},300),egret.Tween.get(this.leftRect).to({x:-this.leftRect.width-200},300).call(function(){t.leftRect.width;t.leftRect.x=0,t.leftRect.width=t.rightRect.width,t.rightRect.x=t.stageW,t.red.x=t.stageW,t.lv=10*(10-Math.ceil(GameData.ins().grade/10));var e=t.randomX(t.lv,70,100);t.rightRect.width=e.width,egret.Tween.get(t.red).to({x:e.x+t.rightRect.width/2-t.red.width/2},500),egret.Tween.get(t.rightRect).to({x:e.x},500).call(function(){t.touchEnabled=!0},t)},this)},e.prototype.showOverTip=function(){this.overCon.visible=!0,this.resultGradeTxt.text=""+GameData.ins().grade,this.bestTxt.text=""+GameData.ins().bestGrade},e.prototype.randomX=function(t,e,i){var n={};n.width=t+Math.floor(Math.random()*e);var r=this.stageW-this.leftRect.width-n.width-i;return n.x=this.leftRect.width+Math.floor(r*Math.random())+i,n},e.prototype.getHeroX=function(t){if(t){var e=t.x+t.width-this.hero.width-16;return e}},e}(eui.Component);__reflect(GameWin.prototype,"GameWin");var Hero=function(t){function e(e){var i=t.call(this)||this;return i._nameStr=["王者啦啦","王者Top","铂金哎呦喂","钻石佳佳","钻石咔咔"],i._nameColor=[16711680,16672514,3421336,6684877,1430684],i.init(e),i}return __extends(e,t),e.prototype.init=function(t){var e=RES.getRes("hero_json"),i=RES.getRes("hero_png");this._mcDataFactory=new egret.MovieClipDataFactory(e,i),this._mc=new egret.MovieClip(this._mcDataFactory.generateMovieClipData("hero"+t)),this.addChild(this._mc),this._mc.gotoAndPlay("stay",-1),this._mc.anchorOffsetY=this._mc.height,this.width=this._mc.width,this._name||(this._name=new egret.TextField,this.addChild(this._name)),this._name.text=this._nameStr[t],this._name.textColor=this._nameColor[t],this._name.size=26,this._name.bold=!0,this._name.y=-(this._mc.height+this._name.height),this._name.x=this.width/2-this._name.width/2},e.prototype.setIndex=function(t){this._mc&&this._mc.parent&&this._mc.parent.removeChild(this._mc),this.init(t)},e}(egret.Sprite);__reflect(Hero.prototype,"Hero");var StageUtils=function(t){function e(){var i=t.call(this)||this;return i.top=0,null==e._uiStage&&(e._uiStage=new eui.UILayer,e._uiStage.touchEnabled=!1,e._uiStage.percentHeight=100,e._uiStage.percentWidth=100,i.getStage().addChild(e._uiStage)),i.getStage().maxTouches=1,"iOS"==egret.Capabilities.os&&375==window.screen.width&&812==window.screen.height&&540==i.getStage().stageWidth&&1170==i.getStage().stageHeight&&(i.top=44),i}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.getHeight=function(){return this.getStage().stageHeight},e.prototype.getWidth=function(){return this.getStage().stageWidth},e.prototype.setTouchChildren=function(t){this.getStage().touchChildren=t},e.prototype.setMaxTouches=function(t){this.getStage().maxTouches=t},e.prototype.setFrameRate=function(t){this.getStage().frameRate=t},e.prototype.setScaleMode=function(t){this.getStage().scaleMode=t},e.prototype.getStage=function(){return egret.MainContext.instance.stage},e.prototype.getUIStage=function(){return e._uiStage},e.w=540,e.h=930,e}(BaseClass);__reflect(StageUtils.prototype,"StageUtils");